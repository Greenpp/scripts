#!/bin/bash

if [[ ! -f $HOME/.music_to_download ]]; then
    echo "No download file"
    exit 0
fi

tmp_file=$(mktemp)

cd $HOME/Music/Downloads
for url in $(cat $HOME/.music_to_download); do
    echo -n "Downloading $(youtube-dl --no-warnings --get-title $url 2>/dev/null)..."
    sleep 3
    youtube-dl --extract-audio --audio-format mp3 --audio-quality 0 $url >/dev/null 2>&1

    if [[ $? -eq 0 ]]; then
        echo 'Done'
    else
        echo 'Error'
        echo $url >> $tmp_file
    fi
    sleep 3
done

mv $tmp_file $HOME/.music_to_download

